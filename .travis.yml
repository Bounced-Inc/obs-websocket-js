language: node_js
node_js:
  - "8"
  - "10"

cache:
  directories:
    - node_modules

notifications:
  email: false

env:
  global:
    - GH_REF="github.com/haganbmj/obs-websocket-js"
    - DEBUG="obs-websocket-js:*"

before_script:
  - npm install json -g
  - bash ./.travis/pre-build.sh
  - npm install

script:
  - npm run build
  - npm test

branches:
  except:
    - /^v\d+\.\d+\.\d+$/

jobs:
  include:
    - stage: deploy
      script:
        - npm run build
        - bash ./.travis/gh-pages.sh
        - npm run node-coveralls
      node_js: 10
